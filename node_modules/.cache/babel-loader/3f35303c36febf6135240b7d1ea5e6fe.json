{"remainingRequest":"C:\\work\\code\\iview-admin\\node_modules\\babel-loader\\lib\\index.js!C:\\work\\code\\iview-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\work\\code\\iview-admin\\src\\view\\main\\components\\tags-nav\\tags-nav.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\work\\code\\iview-admin\\src\\view\\main\\components\\tags-nav\\tags-nav.vue","mtime":1535094297808},{"path":"C:\\work\\code\\iview-admin\\.babelrc","mtime":1535094296553},{"path":"C:\\work\\code\\iview-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1535091260613},{"path":"C:\\work\\code\\iview-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"C:\\work\\code\\iview-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { showTitle, routeEqual } from '@/libs/util';\nexport default {\n  name: 'TagsNav',\n  props: {\n    value: Object,\n    list: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  data: function data() {\n    return {\n      tagBodyLeft: 0,\n      rightOffset: 40,\n      outerPadding: 4\n    };\n  },\n  computed: {\n    currentRouteObj: function currentRouteObj() {\n      var _this$value = this.value,\n          name = _this$value.name,\n          params = _this$value.params,\n          query = _this$value.query;\n      return {\n        name: name,\n        params: params,\n        query: query\n      };\n    }\n  },\n  methods: {\n    handlescroll: function handlescroll(e) {\n      var type = e.type;\n      var delta = 0;\n\n      if (type === 'DOMMouseScroll' || type === 'mousewheel') {\n        delta = e.wheelDelta ? e.wheelDelta : -(e.detail || 0) * 40;\n      }\n\n      this.handleScroll(delta);\n    },\n    handleScroll: function handleScroll(offset) {\n      var outerWidth = this.$refs.scrollOuter.offsetWidth;\n      var bodyWidth = this.$refs.scrollBody.offsetWidth;\n\n      if (offset > 0) {\n        this.tagBodyLeft = Math.min(0, this.tagBodyLeft + offset);\n      } else {\n        if (outerWidth < bodyWidth) {\n          if (this.tagBodyLeft < -(bodyWidth - outerWidth)) {\n            this.tagBodyLeft = this.tagBodyLeft;\n          } else {\n            this.tagBodyLeft = Math.max(this.tagBodyLeft + offset, outerWidth - bodyWidth);\n          }\n        } else {\n          this.tagBodyLeft = 0;\n        }\n      }\n    },\n    handleTagsOption: function handleTagsOption(type) {\n      var _this = this;\n\n      if (type === 'close-all') {\n        // 关闭所有，除了home\n        var res = this.list.filter(function (item) {\n          return item.name === 'home';\n        });\n        this.$emit('on-close', res, 'all');\n      } else {\n        // 关闭除当前页和home页的其他页\n        var _res = this.list.filter(function (item) {\n          return routeEqual(_this.currentRouteObj, item) || item.name === 'home';\n        });\n\n        this.$emit('on-close', _res, 'others', this.currentRouteObj);\n        setTimeout(function () {\n          _this.getTagElementByName(_this.currentRouteObj.name);\n        }, 100);\n      }\n    },\n    handleClose: function handleClose(current) {\n      var res = this.list.filter(function (item) {\n        return !routeEqual(current, item);\n      });\n      this.$emit('on-close', res, undefined, current);\n    },\n    handleClick: function handleClick(item) {\n      this.$emit('input', item);\n    },\n    showTitleInside: function showTitleInside(item) {\n      return showTitle(item, this);\n    },\n    isCurrentTag: function isCurrentTag(item) {\n      return routeEqual(this.currentRouteObj, item);\n    },\n    moveToView: function moveToView(tag) {\n      var outerWidth = this.$refs.scrollOuter.offsetWidth;\n      var bodyWidth = this.$refs.scrollBody.offsetWidth;\n\n      if (bodyWidth < outerWidth) {\n        this.tagBodyLeft = 0;\n      } else if (tag.offsetLeft < -this.tagBodyLeft) {\n        // 标签在可视区域左侧\n        this.tagBodyLeft = -tag.offsetLeft + this.outerPadding;\n      } else if (tag.offsetLeft > -this.tagBodyLeft && tag.offsetLeft + tag.offsetWidth < -this.tagBodyLeft + outerWidth) {\n        // 标签在可视区域\n        this.tagBodyLeft = Math.min(0, outerWidth - tag.offsetWidth - tag.offsetLeft - this.outerPadding);\n      } else {\n        // 标签在可视区域右侧\n        this.tagBodyLeft = -(tag.offsetLeft - (outerWidth - this.outerPadding - tag.offsetWidth));\n      }\n    },\n    getTagElementByName: function getTagElementByName(name) {\n      var _this2 = this;\n\n      this.$nextTick(function () {\n        _this2.refsTag = _this2.$refs.tagsPageOpened;\n\n        _this2.refsTag.forEach(function (item, index) {\n          if (name === item.name) {\n            var tag = _this2.refsTag[index].$el;\n\n            _this2.moveToView(tag);\n          }\n        });\n      });\n    }\n  },\n  watch: {\n    '$route': function $route(to) {\n      this.getTagElementByName(to.name);\n    }\n  },\n  mounted: function mounted() {\n    var _this3 = this;\n\n    setTimeout(function () {\n      _this3.getTagElementByName(_this3.$route.name);\n    }, 200);\n  }\n};",{"version":3,"sources":["tags-nav.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"tags-nav\">\r\n    <div class=\"close-con\">\r\n      <Dropdown transfer @on-click=\"handleTagsOption\" style=\"margin-top:7px;\">\r\n        <Button size=\"small\" type=\"text\">\r\n          <Icon :size=\"18\" type=\"ios-close-circle-outline\" />\r\n        </Button>\r\n        <DropdownMenu slot=\"list\">\r\n          <DropdownItem name=\"close-all\">关闭所有</DropdownItem>\r\n          <DropdownItem name=\"close-others\">关闭其他</DropdownItem>\r\n        </DropdownMenu>\r\n      </Dropdown>\r\n    </div>\r\n    <div class=\"btn-con left-btn\">\r\n      <Button type=\"text\" @click=\"handleScroll(240)\">\r\n        <Icon :size=\"18\" type=\"ios-arrow-back\" />\r\n      </Button>\r\n    </div>\r\n    <div class=\"btn-con right-btn\">\r\n      <Button type=\"text\" @click=\"handleScroll(-240)\">\r\n        <Icon :size=\"18\" type=\"ios-arrow-forward\" />\r\n      </Button>\r\n    </div>\r\n    <div class=\"scroll-outer\" ref=\"scrollOuter\" @DOMMouseScroll=\"handlescroll\" @mousewheel=\"handlescroll\">\r\n      <div ref=\"scrollBody\" class=\"scroll-body\" :style=\"{left: tagBodyLeft + 'px'}\">\r\n        <transition-group name=\"taglist-moving-animation\">\r\n          <Tag\r\n            type=\"dot\"\r\n            v-for=\"(item, index) in list\"\r\n            ref=\"tagsPageOpened\"\r\n            :key=\"`tag-nav-${index}`\"\r\n            :name=\"item.name\"\r\n            @on-close=\"handleClose(item)\"\r\n            @click.native=\"handleClick(item)\"\r\n            :closable=\"item.name !== 'home'\"\r\n            :color=\"isCurrentTag(item) ? 'primary' : 'default'\"\r\n          >{{ showTitleInside(item) }}</Tag>\r\n        </transition-group>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { showTitle, routeEqual } from '@/libs/util'\r\nexport default {\r\n  name: 'TagsNav',\r\n  props: {\r\n    value: Object,\r\n    list: {\r\n      type: Array,\r\n      default () {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      tagBodyLeft: 0,\r\n      rightOffset: 40,\r\n      outerPadding: 4\r\n    }\r\n  },\r\n  computed: {\r\n    currentRouteObj () {\r\n      const { name, params, query } = this.value\r\n      return { name, params, query }\r\n    }\r\n  },\r\n  methods: {\r\n    handlescroll (e) {\r\n      var type = e.type\r\n      let delta = 0\r\n      if (type === 'DOMMouseScroll' || type === 'mousewheel') {\r\n        delta = (e.wheelDelta) ? e.wheelDelta : -(e.detail || 0) * 40\r\n      }\r\n      this.handleScroll(delta)\r\n    },\r\n    handleScroll (offset) {\r\n      const outerWidth = this.$refs.scrollOuter.offsetWidth\r\n      const bodyWidth = this.$refs.scrollBody.offsetWidth\r\n      if (offset > 0) {\r\n        this.tagBodyLeft = Math.min(0, this.tagBodyLeft + offset)\r\n      } else {\r\n        if (outerWidth < bodyWidth) {\r\n          if (this.tagBodyLeft < -(bodyWidth - outerWidth)) {\r\n            this.tagBodyLeft = this.tagBodyLeft\r\n          } else {\r\n            this.tagBodyLeft = Math.max(this.tagBodyLeft + offset, outerWidth - bodyWidth)\r\n          }\r\n        } else {\r\n          this.tagBodyLeft = 0\r\n        }\r\n      }\r\n    },\r\n    handleTagsOption (type) {\r\n      if (type === 'close-all') {\r\n        // 关闭所有，除了home\r\n        let res = this.list.filter(item => item.name === 'home')\r\n        this.$emit('on-close', res, 'all')\r\n      } else {\r\n        // 关闭除当前页和home页的其他页\r\n        let res = this.list.filter(item => routeEqual(this.currentRouteObj, item) || item.name === 'home')\r\n        this.$emit('on-close', res, 'others', this.currentRouteObj)\r\n        setTimeout(() => {\r\n          this.getTagElementByName(this.currentRouteObj.name)\r\n        }, 100)\r\n      }\r\n    },\r\n    handleClose (current) {\r\n      let res = this.list.filter(item => !routeEqual(current, item))\r\n      this.$emit('on-close', res, undefined, current)\r\n    },\r\n    handleClick (item) {\r\n      this.$emit('input', item)\r\n    },\r\n    showTitleInside (item) {\r\n      return showTitle(item, this)\r\n    },\r\n    isCurrentTag (item) {\r\n      return routeEqual(this.currentRouteObj, item)\r\n    },\r\n    moveToView (tag) {\r\n      const outerWidth = this.$refs.scrollOuter.offsetWidth\r\n      const bodyWidth = this.$refs.scrollBody.offsetWidth\r\n      if (bodyWidth < outerWidth) {\r\n        this.tagBodyLeft = 0\r\n      } else if (tag.offsetLeft < -this.tagBodyLeft) {\r\n        // 标签在可视区域左侧\r\n        this.tagBodyLeft = -tag.offsetLeft + this.outerPadding\r\n      } else if (tag.offsetLeft > -this.tagBodyLeft && tag.offsetLeft + tag.offsetWidth < -this.tagBodyLeft + outerWidth) {\r\n        // 标签在可视区域\r\n        this.tagBodyLeft = Math.min(0, outerWidth - tag.offsetWidth - tag.offsetLeft - this.outerPadding)\r\n      } else {\r\n        // 标签在可视区域右侧\r\n        this.tagBodyLeft = -(tag.offsetLeft - (outerWidth - this.outerPadding - tag.offsetWidth))\r\n      }\r\n    },\r\n    getTagElementByName (name) {\r\n      this.$nextTick(() => {\r\n        this.refsTag = this.$refs.tagsPageOpened\r\n        this.refsTag.forEach((item, index) => {\r\n          if (name === item.name) {\r\n            let tag = this.refsTag[index].$el\r\n            this.moveToView(tag)\r\n          }\r\n        })\r\n      })\r\n    }\r\n  },\r\n  watch: {\r\n    '$route' (to) {\r\n      this.getTagElementByName(to.name)\r\n    }\r\n  },\r\n  mounted () {\r\n    setTimeout(() => {\r\n      this.getTagElementByName(this.$route.name)\r\n    }, 200)\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\">\r\n@import './tags-nav.less';\r\n</style>\r\n"],"sourceRoot":"src\\view\\main\\components\\tags-nav"}]}