{"remainingRequest":"C:\\work\\code\\iview-admin\\node_modules\\babel-loader\\lib\\index.js!C:\\work\\code\\iview-admin\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\work\\code\\iview-admin\\src\\libs\\util.js","dependencies":[{"path":"C:\\work\\code\\iview-admin\\src\\libs\\util.js","mtime":1535094297194},{"path":"C:\\work\\code\\iview-admin\\.babelrc","mtime":1535094296553},{"path":"C:\\work\\code\\iview-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1535091260613},{"path":"C:\\work\\code\\iview-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":1529635966000},{"path":"C:\\work\\code\\iview-admin\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.array.find-index\";\nimport \"core-js/modules/es6.object.assign\";\nimport _toConsumableArray from \"C:\\\\work\\\\code\\\\iview-admin\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/toConsumableArray\";\nimport \"core-js/modules/es6.function.name\";\nimport Cookies from 'js-cookie'; // cookie保存的天数\n\nimport config from '@/config';\nimport { forEach, hasOneOf, objEqual } from '@/libs/tools';\nexport var TOKEN_KEY = 'token';\nexport var setToken = function setToken(token) {\n  Cookies.set(TOKEN_KEY, token, {\n    expires: config.cookieExpires || 1\n  });\n};\nexport var getToken = function getToken() {\n  var token = Cookies.get(TOKEN_KEY);\n  if (token) return token;else return false;\n};\nexport var hasChild = function hasChild(item) {\n  return item.children && item.children.length !== 0;\n};\n\nvar showThisMenuEle = function showThisMenuEle(item, access) {\n  if (item.meta && item.meta.access && item.meta.access.length) {\n    if (hasOneOf(item.meta.access, access)) return true;else return false;\n  } else return true;\n};\n/**\r\n * @param {Array} list 通过路由列表得到菜单列表\r\n * @returns {Array}\r\n */\n\n\nexport var getMenuByRouter = function getMenuByRouter(list, access) {\n  var res = [];\n  forEach(list, function (item) {\n    if (!item.meta || item.meta && !item.meta.hideInMenu) {\n      var obj = {\n        icon: item.meta && item.meta.icon || '',\n        name: item.name,\n        meta: item.meta\n      };\n\n      if ((hasChild(item) || item.meta && item.meta.showAlways) && showThisMenuEle(item, access)) {\n        obj.children = getMenuByRouter(item.children, access);\n      }\n\n      if (item.meta && item.meta.href) obj.href = item.meta.href;\n      if (showThisMenuEle(item, access)) res.push(obj);\n    }\n  });\n  return res;\n};\n/**\r\n * @param {Array} routeMetched 当前路由metched\r\n * @returns {Array}\r\n */\n\nexport var getBreadCrumbList = function getBreadCrumbList(routeMetched, homeRoute) {\n  var res = routeMetched.filter(function (item) {\n    return item.meta === undefined || !item.meta.hide;\n  }).map(function (item) {\n    var obj = {\n      icon: item.meta && item.meta.icon || '',\n      name: item.name,\n      meta: item.meta\n    };\n    return obj;\n  });\n  res = res.filter(function (item) {\n    return !item.meta.hideInMenu;\n  });\n  return [Object.assign(homeRoute, {\n    to: homeRoute.path\n  })].concat(_toConsumableArray(res));\n};\nexport var showTitle = function showTitle(item, vm) {\n  return vm.$config.useI18n ? vm.$t(item.name) : item.meta && item.meta.title || item.name;\n};\n/**\r\n * @description 本地存储和获取标签导航列表\r\n */\n\nexport var setTagNavListInLocalstorage = function setTagNavListInLocalstorage(list) {\n  localStorage.tagNaveList = JSON.stringify(list);\n};\n/**\r\n * @returns {Array} 其中的每个元素只包含路由原信息中的name, path, meta三项\r\n */\n\nexport var getTagNavListFromLocalstorage = function getTagNavListFromLocalstorage() {\n  var list = localStorage.tagNaveList;\n  return list ? JSON.parse(list) : [];\n};\n/**\r\n * @param {Array} routers 路由列表数组\r\n * @description 用于找到路由列表中name为home的对象\r\n */\n\nexport var getHomeRoute = function getHomeRoute(routers) {\n  var i = -1;\n  var len = routers.length;\n  var homeRoute = {};\n\n  while (++i < len) {\n    var item = routers[i];\n\n    if (item.children && item.children.length) {\n      var res = getHomeRoute(item.children);\n      if (res.name) return res;\n    } else {\n      if (item.name === 'home') homeRoute = item;\n    }\n  }\n\n  return homeRoute;\n};\n/**\r\n * @param {*} list 现有标签导航列表\r\n * @param {*} newRoute 新添加的路由原信息对象\r\n * @description 如果该newRoute已经存在则不再添加\r\n */\n\nexport var getNewTagList = function getNewTagList(list, newRoute) {\n  var name = newRoute.name,\n      path = newRoute.path,\n      meta = newRoute.meta;\n\n  var newList = _toConsumableArray(list);\n\n  if (newList.findIndex(function (item) {\n    return item.name === name;\n  }) >= 0) return newList;else newList.push({\n    name: name,\n    path: path,\n    meta: meta\n  });\n  return newList;\n};\n/**\r\n * @param {*} access 用户权限数组，如 ['super_admin', 'admin']\r\n * @param {*} route 路由列表\r\n */\n\nvar hasAccess = function hasAccess(access, route) {\n  if (route.meta && route.meta.access) return hasOneOf(access, route.meta.access);else return true;\n};\n/**\r\n * 权鉴\r\n * @param {*} name 即将跳转的路由name\r\n * @param {*} access 用户权限数组\r\n * @param {*} routes 路由列表\r\n * @description 用户是否可跳转到该页\r\n */\n\n\nexport var canTurnTo = function canTurnTo(name, access, routes) {\n  var routePermissionJudge = function routePermissionJudge(list) {\n    return list.some(function (item) {\n      if (item.children && item.children.length) {\n        return routePermissionJudge(item.children);\n      } else if (item.name === name) {\n        return hasAccess(access, item);\n      }\n    });\n  };\n\n  return routePermissionJudge(routes);\n};\n/**\r\n * @param {String} url\r\n * @description 从URL中解析参数\r\n */\n\nexport var getParams = function getParams(url) {\n  var keyValueArr = url.split('?')[1].split('&');\n  var paramObj = {};\n  keyValueArr.forEach(function (item) {\n    var keyValue = item.split('=');\n    paramObj[keyValue[0]] = keyValue[1];\n  });\n  return paramObj;\n};\n/**\r\n * @param {Array} list 标签列表\r\n * @param {String} name 当前关闭的标签的name\r\n */\n\nexport var getNextRoute = function getNextRoute(list, route) {\n  var res = {};\n\n  if (list.length === 2) {\n    res = getHomeRoute(list);\n  } else {\n    var index = list.findIndex(function (item) {\n      return routeEqual(item, route);\n    });\n    if (index === list.length - 1) res = list[list.length - 2];else res = list[index + 1];\n  }\n\n  return res;\n};\n/**\r\n * @param {Number} times 回调函数需要执行的次数\r\n * @param {Function} callback 回调函数\r\n */\n\nexport var doCustomTimes = function doCustomTimes(times, callback) {\n  var i = -1;\n\n  while (++i < times) {\n    callback(i);\n  }\n};\n/**\r\n * @param {Object} file 从上传组件得到的文件对象\r\n * @returns {Promise} resolve参数是解析后的二维数组\r\n * @description 从Csv文件中解析出表格，解析成二维数组\r\n */\n\nexport var getArrayFromFile = function getArrayFromFile(file) {\n  var nameSplit = file.name.split('.');\n  var format = nameSplit[nameSplit.length - 1];\n  return new Promise(function (resolve, reject) {\n    var reader = new FileReader();\n    reader.readAsText(file); // 以文本格式读取\n\n    var arr = [];\n\n    reader.onload = function (evt) {\n      var data = evt.target.result; // 读到的数据\n\n      var pasteData = data.trim();\n      arr = pasteData.split(/[\\n\\u0085\\u2028\\u2029]|\\r\\n?/g).map(function (row) {\n        return row.split('\\t');\n      }).map(function (item) {\n        return item[0].split(',');\n      });\n      if (format === 'csv') resolve(arr);else reject(new Error('[Format Error]:你上传的不是Csv文件'));\n    };\n  });\n};\n/**\r\n * @param {Array} array 表格数据二维数组\r\n * @returns {Object} { columns, tableData }\r\n * @description 从二维数组中获取表头和表格数据，将第一行作为表头，用于在iView的表格中展示数据\r\n */\n\nexport var getTableDataFromArray = function getTableDataFromArray(array) {\n  var columns = [];\n  var tableData = [];\n\n  if (array.length > 1) {\n    var titles = array.shift();\n    columns = titles.map(function (item) {\n      return {\n        title: item,\n        key: item\n      };\n    });\n    tableData = array.map(function (item) {\n      var res = {};\n      item.forEach(function (col, i) {\n        res[titles[i]] = col;\n      });\n      return res;\n    });\n  }\n\n  return {\n    columns: columns,\n    tableData: tableData\n  };\n};\nexport var findNodeUpper = function findNodeUpper(ele, tag) {\n  if (ele.parentNode) {\n    if (ele.parentNode.tagName === tag.toUpperCase()) {\n      return ele.parentNode;\n    } else {\n      return findNodeUpper(ele.parentNode, tag);\n    }\n  }\n};\nexport var findNodeDownward = function findNodeDownward(ele, tag) {\n  var tagName = tag.toUpperCase();\n\n  if (ele.childNodes.length) {\n    var i = -1;\n    var len = ele.childNodes.length;\n\n    while (++i < len) {\n      var child = ele.childNodes[i];\n      if (child.tagName === tagName) return child;else return findNodeDownward(child, tag);\n    }\n  }\n};\nexport var showByAccess = function showByAccess(access, canViewAccess) {\n  return hasOneOf(canViewAccess, access);\n};\n/**\r\n * @description 根据name/params/query判断两个路由对象是否相等\r\n * @param {*} route1 路由对象\r\n * @param {*} route2 路由对象\r\n */\n\nexport var routeEqual = function routeEqual(route1, route2) {\n  var params1 = route1.params || {};\n  var params2 = route2.params || {};\n  var query1 = route1.query || {};\n  var query2 = route2.query || {};\n  return route1.name === route2.name && objEqual(params1, params2) && objEqual(query1, query2);\n};\n/**\r\n * 判断打开的标签列表里是否已存在这个新添加的路由对象\r\n */\n\nexport var routeHasExist = function routeHasExist(tagNavList, routeItem) {\n  var len = tagNavList.length;\n  var res = false;\n  doCustomTimes(len, function (index) {\n    if (routeEqual(tagNavList[index], routeItem)) res = true;\n  });\n  return res;\n};",{"version":3,"sources":["src\\libs\\util.js"],"names":["Cookies","config","forEach","hasOneOf","objEqual","TOKEN_KEY","setToken","token","set","expires","cookieExpires","getToken","get","hasChild","item","children","length","showThisMenuEle","access","meta","getMenuByRouter","list","res","hideInMenu","obj","icon","name","showAlways","href","push","getBreadCrumbList","routeMetched","homeRoute","filter","undefined","hide","map","Object","assign","to","path","showTitle","vm","$config","useI18n","$t","title","setTagNavListInLocalstorage","localStorage","tagNaveList","JSON","stringify","getTagNavListFromLocalstorage","parse","getHomeRoute","i","len","routers","getNewTagList","newRoute","newList","findIndex","hasAccess","route","canTurnTo","routes","routePermissionJudge","some","getParams","keyValueArr","url","split","paramObj","keyValue","getNextRoute","index","routeEqual","doCustomTimes","times","callback","getArrayFromFile","file","nameSplit","format","Promise","resolve","reject","reader","FileReader","readAsText","arr","onload","evt","data","target","result","pasteData","trim","row","Error","getTableDataFromArray","array","columns","tableData","titles","shift","key","col","findNodeUpper","ele","tag","parentNode","tagName","toUpperCase","findNodeDownward","childNodes","child","showByAccess","canViewAccess","route1","route2","params1","params","params2","query1","query","query2","routeHasExist","tagNavList","routeItem"],"mappings":"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","sourceRoot":"C:\\work\\code\\iview-admin","sourcesContent":["import Cookies from 'js-cookie'\r\n// cookie保存的天数\r\nimport config from '@/config'\r\nimport { forEach, hasOneOf, objEqual } from '@/libs/tools'\r\n\r\nexport const TOKEN_KEY = 'token'\r\n\r\nexport const setToken = (token) => {\r\n  Cookies.set(TOKEN_KEY, token, {expires: config.cookieExpires || 1})\r\n}\r\n\r\nexport const getToken = () => {\r\n  const token = Cookies.get(TOKEN_KEY)\r\n  if (token) return token\r\n  else return false\r\n}\r\n\r\nexport const hasChild = (item) => {\r\n  return item.children && item.children.length !== 0\r\n}\r\n\r\nconst showThisMenuEle = (item, access) => {\r\n  if (item.meta && item.meta.access && item.meta.access.length) {\r\n    if (hasOneOf(item.meta.access, access)) return true\r\n    else return false\r\n  } else return true\r\n}\r\n/**\r\n * @param {Array} list 通过路由列表得到菜单列表\r\n * @returns {Array}\r\n */\r\nexport const getMenuByRouter = (list, access) => {\r\n  let res = []\r\n  forEach(list, item => {\r\n    if (!item.meta || (item.meta && !item.meta.hideInMenu)) {\r\n      let obj = {\r\n        icon: (item.meta && item.meta.icon) || '',\r\n        name: item.name,\r\n        meta: item.meta\r\n      }\r\n      if ((hasChild(item) || (item.meta && item.meta.showAlways)) && showThisMenuEle(item, access)) {\r\n        obj.children = getMenuByRouter(item.children, access)\r\n      }\r\n      if (item.meta && item.meta.href) obj.href = item.meta.href\r\n      if (showThisMenuEle(item, access)) res.push(obj)\r\n    }\r\n  })\r\n  return res\r\n}\r\n\r\n/**\r\n * @param {Array} routeMetched 当前路由metched\r\n * @returns {Array}\r\n */\r\nexport const getBreadCrumbList = (routeMetched, homeRoute) => {\r\n  let res = routeMetched.filter(item => {\r\n    return item.meta === undefined || !item.meta.hide\r\n  }).map(item => {\r\n    let obj = {\r\n      icon: (item.meta && item.meta.icon) || '',\r\n      name: item.name,\r\n      meta: item.meta\r\n    }\r\n    return obj\r\n  })\r\n  res = res.filter(item => {\r\n    return !item.meta.hideInMenu\r\n  })\r\n  return [Object.assign(homeRoute, { to: homeRoute.path }), ...res]\r\n}\r\n\r\nexport const showTitle = (item, vm) => vm.$config.useI18n ? vm.$t(item.name) : ((item.meta && item.meta.title) || item.name)\r\n\r\n/**\r\n * @description 本地存储和获取标签导航列表\r\n */\r\nexport const setTagNavListInLocalstorage = list => {\r\n  localStorage.tagNaveList = JSON.stringify(list)\r\n}\r\n/**\r\n * @returns {Array} 其中的每个元素只包含路由原信息中的name, path, meta三项\r\n */\r\nexport const getTagNavListFromLocalstorage = () => {\r\n  const list = localStorage.tagNaveList\r\n  return list ? JSON.parse(list) : []\r\n}\r\n\r\n/**\r\n * @param {Array} routers 路由列表数组\r\n * @description 用于找到路由列表中name为home的对象\r\n */\r\nexport const getHomeRoute = routers => {\r\n  let i = -1\r\n  let len = routers.length\r\n  let homeRoute = {}\r\n  while (++i < len) {\r\n    let item = routers[i]\r\n    if (item.children && item.children.length) {\r\n      let res = getHomeRoute(item.children)\r\n      if (res.name) return res\r\n    } else {\r\n      if (item.name === 'home') homeRoute = item\r\n    }\r\n  }\r\n  return homeRoute\r\n}\r\n\r\n/**\r\n * @param {*} list 现有标签导航列表\r\n * @param {*} newRoute 新添加的路由原信息对象\r\n * @description 如果该newRoute已经存在则不再添加\r\n */\r\nexport const getNewTagList = (list, newRoute) => {\r\n  const { name, path, meta } = newRoute\r\n  let newList = [...list]\r\n  if (newList.findIndex(item => item.name === name) >= 0) return newList\r\n  else newList.push({ name, path, meta })\r\n  return newList\r\n}\r\n\r\n/**\r\n * @param {*} access 用户权限数组，如 ['super_admin', 'admin']\r\n * @param {*} route 路由列表\r\n */\r\nconst hasAccess = (access, route) => {\r\n  if (route.meta && route.meta.access) return hasOneOf(access, route.meta.access)\r\n  else return true\r\n}\r\n\r\n/**\r\n * 权鉴\r\n * @param {*} name 即将跳转的路由name\r\n * @param {*} access 用户权限数组\r\n * @param {*} routes 路由列表\r\n * @description 用户是否可跳转到该页\r\n */\r\nexport const canTurnTo = (name, access, routes) => {\r\n  const routePermissionJudge = (list) => {\r\n    return list.some(item => {\r\n      if (item.children && item.children.length) {\r\n        return routePermissionJudge(item.children)\r\n      } else if (item.name === name) {\r\n        return hasAccess(access, item)\r\n      }\r\n    })\r\n  }\r\n\r\n  return routePermissionJudge(routes)\r\n}\r\n\r\n/**\r\n * @param {String} url\r\n * @description 从URL中解析参数\r\n */\r\nexport const getParams = url => {\r\n  const keyValueArr = url.split('?')[1].split('&')\r\n  let paramObj = {}\r\n  keyValueArr.forEach(item => {\r\n    const keyValue = item.split('=')\r\n    paramObj[keyValue[0]] = keyValue[1]\r\n  })\r\n  return paramObj\r\n}\r\n\r\n/**\r\n * @param {Array} list 标签列表\r\n * @param {String} name 当前关闭的标签的name\r\n */\r\nexport const getNextRoute = (list, route) => {\r\n  let res = {}\r\n  if (list.length === 2) {\r\n    res = getHomeRoute(list)\r\n  } else {\r\n    const index = list.findIndex(item => routeEqual(item, route))\r\n    if (index === list.length - 1) res = list[list.length - 2]\r\n    else res = list[index + 1]\r\n  }\r\n  return res\r\n}\r\n\r\n/**\r\n * @param {Number} times 回调函数需要执行的次数\r\n * @param {Function} callback 回调函数\r\n */\r\nexport const doCustomTimes = (times, callback) => {\r\n  let i = -1\r\n  while (++i < times) {\r\n    callback(i)\r\n  }\r\n}\r\n\r\n/**\r\n * @param {Object} file 从上传组件得到的文件对象\r\n * @returns {Promise} resolve参数是解析后的二维数组\r\n * @description 从Csv文件中解析出表格，解析成二维数组\r\n */\r\nexport const getArrayFromFile = (file) => {\r\n  let nameSplit = file.name.split('.')\r\n  let format = nameSplit[nameSplit.length - 1]\r\n  return new Promise((resolve, reject) => {\r\n    let reader = new FileReader()\r\n    reader.readAsText(file) // 以文本格式读取\r\n    let arr = []\r\n    reader.onload = function (evt) {\r\n      let data = evt.target.result // 读到的数据\r\n      let pasteData = data.trim()\r\n      arr = pasteData.split((/[\\n\\u0085\\u2028\\u2029]|\\r\\n?/g)).map(row => {\r\n        return row.split('\\t')\r\n      }).map(item => {\r\n        return item[0].split(',')\r\n      })\r\n      if (format === 'csv') resolve(arr)\r\n      else reject(new Error('[Format Error]:你上传的不是Csv文件'))\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * @param {Array} array 表格数据二维数组\r\n * @returns {Object} { columns, tableData }\r\n * @description 从二维数组中获取表头和表格数据，将第一行作为表头，用于在iView的表格中展示数据\r\n */\r\nexport const getTableDataFromArray = (array) => {\r\n  let columns = []\r\n  let tableData = []\r\n  if (array.length > 1) {\r\n    let titles = array.shift()\r\n    columns = titles.map(item => {\r\n      return {\r\n        title: item,\r\n        key: item\r\n      }\r\n    })\r\n    tableData = array.map(item => {\r\n      let res = {}\r\n      item.forEach((col, i) => {\r\n        res[titles[i]] = col\r\n      })\r\n      return res\r\n    })\r\n  }\r\n  return {\r\n    columns,\r\n    tableData\r\n  }\r\n}\r\n\r\nexport const findNodeUpper = (ele, tag) => {\r\n  if (ele.parentNode) {\r\n    if (ele.parentNode.tagName === tag.toUpperCase()) {\r\n      return ele.parentNode\r\n    } else {\r\n      return findNodeUpper(ele.parentNode, tag)\r\n    }\r\n  }\r\n}\r\n\r\nexport const findNodeDownward = (ele, tag) => {\r\n  const tagName = tag.toUpperCase()\r\n  if (ele.childNodes.length) {\r\n    let i = -1\r\n    let len = ele.childNodes.length\r\n    while (++i < len) {\r\n      let child = ele.childNodes[i]\r\n      if (child.tagName === tagName) return child\r\n      else return findNodeDownward(child, tag)\r\n    }\r\n  }\r\n}\r\n\r\nexport const showByAccess = (access, canViewAccess) => {\r\n  return hasOneOf(canViewAccess, access)\r\n}\r\n\r\n/**\r\n * @description 根据name/params/query判断两个路由对象是否相等\r\n * @param {*} route1 路由对象\r\n * @param {*} route2 路由对象\r\n */\r\nexport const routeEqual = (route1, route2) => {\r\n  const params1 = route1.params || {}\r\n  const params2 = route2.params || {}\r\n  const query1 = route1.query || {}\r\n  const query2 = route2.query || {}\r\n  return (route1.name === route2.name) && objEqual(params1, params2) && objEqual(query1, query2)\r\n}\r\n\r\n/**\r\n * 判断打开的标签列表里是否已存在这个新添加的路由对象\r\n */\r\nexport const routeHasExist = (tagNavList, routeItem) => {\r\n  let len = tagNavList.length\r\n  let res = false\r\n  doCustomTimes(len, (index) => {\r\n    if (routeEqual(tagNavList[index], routeItem)) res = true\r\n  })\r\n  return res\r\n}\r\n"]}]}